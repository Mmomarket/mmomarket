<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MMOMarket - Intermediações</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <header>
        <div class="logo">
            <a href="index.html"><img src="images/logo.png" alt="MMOMarket Logo"></a>
        </div>
        <div class="cart-icon">
            <a href="carrinho.html" id="cart-link">
                <img src="images/cart.png" alt="Carrinho">
                <span class="cart-notification" id="cart-count">0</span>
            </a>
        </div>
    </header>
    
    <nav>
        <ul>
            <li><a href="index.html">Início</a></li>
            <li><a href="listajogos.html">Comprar Moedas</a></li>
            <li><a href="intermediar.html">Intermediações</a></li>
        </ul>
    </nav>
    
    <main>
        <section class="intermediation-form">
            <h1>Solicitar Intermediação</h1>
            
            <form id="intermediation-form">
                <div class="form-group">
                    <label for="game">Selecione o jogo desejado:</label>
                    <select id="game" required>
                        <option value="">Escolha um jogo</option>
                        <option value="Cabal">Cabal</option>
                        <option value="Dofus">Dofus</option>
                        <option value="Habbo">Habbo</option>
                        <option value="Albion">Albion</option>
                        <option value="Ragnarok">Ragnarok</option>
                        <option value="Second Life">Second Life</option>
                        <option value="Throne and Liberty">Throne and Liberty</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="char-name">Nome do seu personagem:</label>
                    <input type="text" id="char-name" maxlength="30" required>
                </div>
                
                <div class="form-group">
                    <label for="other-char-name">Nome do personagem do outro jogador:</label>
                    <input type="text" id="other-char-name" maxlength="30" required>
                </div>
                
                <div class="form-group">
                    <label for="whatsapp">Seu whatsapp para contato:</label>
                    <input type="text" id="whatsapp" placeholder="(XX)XXXXX-XXXX" required>
                </div>
                
                <div class="form-group">
                    <label for="other-whatsapp">Whatsapp do outro jogador (se tiver):</label>
                    <input type="text" id="other-whatsapp" placeholder="(XX)XXXXX-XXXX">
                </div>
                
                <div class="form-group">
                    <label for="trade-description">Descreva a troca que será feita:</label>
                    <textarea id="trade-description" maxlength="200" required></textarea>
                </div>
                
                <div class="fee-notice">
                    <p>Para realizar a intermediação, cobramos uma taxa de 3% do comprador e mais 3% do vendedor.</p>
                </div>
                
                <div class="form-group checkbox">
                    <input type="checkbox" id="agreement" required>
                    <label for="agreement">Estou ciente e gostaria de prosseguir</label>
                </div>
                
                <button type="submit" class="primary-btn">Enviar pedido de intermediação</button>
            </form>
        </section>
        
        <div id="confirmation-modal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2>Pedido Recebido!</h2>
                <p>Dentro das próximas horas, um intermediador entrará em contato com vocês in-game.</p>
                <p>Caso não consiga contato por lá, entrará em contato pelo(s) número(s) de Whatsapp fornecido(s).</p>
                <div class="success-icon">✓</div>
            </div>
        </div>
    </main>
    
    <footer>
        <p>&copy; 2023 MMOMarket - Todos os direitos reservados</p>
    </footer>
    
    <script src="js/main.js"></script>
    <script src="js/carrinho.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('intermediation-form');
            const modal = document.getElementById('confirmation-modal');
            const closeBtn = modal.querySelector('.close');
            
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Colete os dados do formulário
                const game = document.getElementById('game').value;
                const charName = document.getElementById('char-name').value;
                const otherCharName = document.getElementById('other-char-name').value;
                const whatsapp = document.getElementById('whatsapp').value;
                const otherWhatsapp = document.getElementById('other-whatsapp').value;
                const tradeDescription = document.getElementById('trade-description').value;
                
                // Simulação do envio de e-mail (no mundo real, isso seria feito no backend)
                console.log(`Enviando e-mail para contato.mmomarket@gmail.com`);
                console.log(`Assunto: Intermediação - ${game}`);
                console.log(`Corpo: 
                    Jogo: ${game}
                    Nome do personagem: ${charName}
                    Nome do outro personagem: ${otherCharName}
                    Whatsapp: ${whatsapp}
                    Whatsapp do outro jogador: ${otherWhatsapp || 'Não fornecido'}
                    Descrição da troca: ${tradeDescription}
                `);
                
                // Exiba o modal de confirmação
                modal.style.display = 'block';
                
                // Resetar o formulário
                form.reset();
            });
            
            // Fechar o modal quando o usuário clicar no X
            closeBtn.addEventListener('click', function() {
                modal.style.display = 'none';
            });
            
            // Fechar o modal quando o usuário clicar fora dele
            window.addEventListener('click', function(event) {
                if (event.target == modal) {
                    modal.style.display = 'none';
                }
            });
            
            // Validar formato do WhatsApp
            const whatsappInputs = document.querySelectorAll('#whatsapp, #other-whatsapp');
            whatsappInputs.forEach(input => {
                input.addEventListener('input', function() {
                    this.value = this.value.replace(/[^0-9]/g, '');
                    if (this.value.length > 11) {
                        this.value = this.value.slice(0, 11);
                    }
                    
                    if (this.value.length > 0) {
                        let formatted = '';
                        if (this.value.length <= 2) {
                            formatted = `(${this.value}`;
                        } else if (this.value.length <= 7) {
                            formatted = `(${this.value.slice(0, 2)})${this.value.slice(2)}`;
                        } else {
                            formatted = `(${this.value.slice(0, 2)})${this.value.slice(2, 7)}-${this.value.slice(7)}`;
                        }
                        this.value = formatted;
                    }
                });
            });
        });
    </script>
</body>
</html>